"{\"data\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mUndefinedTable\\u001b[0m                            Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[6], line 57\\u001b[0m\\n\\u001b[1;32m     54\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     55\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m find(\\u001b[38;5;28;01mlambda\\u001b[39;00m val: val \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m, output)\\n\\u001b[0;32m---> 57\\u001b[0m df \\u001b[38;5;241m=\\u001b[39m \\u001b[43mexecute_custom_code\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     59\\u001b[0m \\u001b[38;5;66;03m# Post processing code below (source: output_display.py)\\u001b[39;00m\\n\\u001b[1;32m     62\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__custom_output\\u001b[39m():\\n\", \"Cell \\u001b[0;32mIn[6], line 36\\u001b[0m, in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     33\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m:\\n\\u001b[1;32m     34\\u001b[0m     \\u001b[38;5;28;01mpass\\u001b[39;00m\\n\\u001b[0;32m---> 36\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_sync\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m     37\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcode\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     38\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     39\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43manalyze_outputs\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mFalse\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     40\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mupdate_status\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     41\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     42\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     43\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28;01mTrue\\u001b[39;00m:\\n\\u001b[1;32m     44\\u001b[0m     block\\u001b[38;5;241m.\\u001b[39mrun_tests(\\n\\u001b[1;32m     45\\u001b[0m         custom_code\\u001b[38;5;241m=\\u001b[39mcode,\\n\\u001b[1;32m     46\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m     47\\u001b[0m         from_notebook\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mTrue\\u001b[39;00m,\\n\\u001b[1;32m     48\\u001b[0m         update_tests\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m     49\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:649\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    640\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m logger \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    641\\u001b[0m         logger\\u001b[38;5;241m.\\u001b[39mexception(\\n\\u001b[1;32m    642\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mFailed to execute block \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    643\\u001b[0m             \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mmerge_dict(logging_tags, \\u001b[38;5;28mdict\\u001b[39m(\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    647\\u001b[0m             ))\\n\\u001b[1;32m    648\\u001b[0m         )\\n\\u001b[0;32m--> 649\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m err\\n\\u001b[1;32m    650\\u001b[0m \\u001b[38;5;28;01mfinally\\u001b[39;00m:\\n\\u001b[1;32m    651\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m update_status:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:581\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    575\\u001b[0m         upstream_block_uuids \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(\\u001b[38;5;28mmap\\u001b[39m(\\u001b[38;5;28;01mlambda\\u001b[39;00m b: b\\u001b[38;5;241m.\\u001b[39muuid, not_executed_upstream_blocks))\\n\\u001b[1;32m    576\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m(\\n\\u001b[1;32m    577\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mBlock \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124ms upstream blocks have not been executed yet. \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m    578\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mPlease run upstream blocks \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mupstream_block_uuids\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    579\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mbefore running the current block.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    580\\u001b[0m         )\\n\\u001b[0;32m--> 581\\u001b[0m output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    582\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    583\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    584\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    585\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    586\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    587\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    588\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    589\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    590\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    591\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    592\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    593\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    594\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m output[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124moutput\\u001b[39m\\u001b[38;5;124m'\\u001b[39m] \\u001b[38;5;129;01mor\\u001b[39;00m []\\n\\u001b[1;32m    595\\u001b[0m variable_mapping \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:808\\u001b[0m, in \\u001b[0;36mBlock.execute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, input_args, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    805\\u001b[0m     outputs_from_input_vars \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\\u001b[1;32m    807\\u001b[0m \\u001b[38;5;28;01mwith\\u001b[39;00m redirect_stdout(stdout):\\n\\u001b[0;32m--> 808\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_execute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    809\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43moutputs_from_input_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    810\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    811\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    812\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    813\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    814\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    815\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    816\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    817\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    818\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    819\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\n\\u001b[1;32m    820\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    822\\u001b[0m output_message \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m(output\\u001b[38;5;241m=\\u001b[39moutputs)\\n\\u001b[1;32m    824\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m output_message\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/sql/__init__.py:370\\u001b[0m, in \\u001b[0;36mSQLBlock._execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, execution_partition, global_vars, **kwargs)\\u001b[0m\\n\\u001b[1;32m    362\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m_execute_block\\u001b[39m(\\n\\u001b[1;32m    363\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m,\\n\\u001b[1;32m    364\\u001b[0m     outputs_from_input_vars,\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    368\\u001b[0m     \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mkwargs,\\n\\u001b[1;32m    369\\u001b[0m ) \\u001b[38;5;241m-\\u001b[39m\\u001b[38;5;241m>\\u001b[39m List:\\n\\u001b[0;32m--> 370\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[43mexecute_sql_code\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    371\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    372\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;129;43;01mor\\u001b[39;49;00m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mcontent\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    373\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    374\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    375\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/sql/__init__.py:174\\u001b[0m, in \\u001b[0;36mexecute_sql_code\\u001b[0;34m(block, query, execution_partition, global_vars, config_file_loader, configuration)\\u001b[0m\\n\\u001b[1;32m    167\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m execute_raw_sql(\\n\\u001b[1;32m    168\\u001b[0m         loader,\\n\\u001b[1;32m    169\\u001b[0m         block,\\n\\u001b[1;32m    170\\u001b[0m         query_string,\\n\\u001b[1;32m    171\\u001b[0m         should_query\\u001b[38;5;241m=\\u001b[39mshould_query,\\n\\u001b[1;32m    172\\u001b[0m     )\\n\\u001b[1;32m    173\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[0;32m--> 174\\u001b[0m     \\u001b[43mloader\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexport\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    175\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;28;43;01mNone\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    176\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mschema\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    177\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtable_name\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    178\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mquery_string\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mquery_string\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    179\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43mkwargs_shared\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    180\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    182\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m should_query:\\n\\u001b[1;32m    183\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m [\\n\\u001b[1;32m    184\\u001b[0m             loader\\u001b[38;5;241m.\\u001b[39mload(\\n\\u001b[1;32m    185\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mSELECT * FROM \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mschema\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m.\\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mtable_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    186\\u001b[0m                 verbose\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m    187\\u001b[0m             ),\\n\\u001b[1;32m    188\\u001b[0m         ]\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:263\\u001b[0m, in \\u001b[0;36mBaseSQL.export\\u001b[0;34m(self, df, schema_name, table_name, if_exists, index, verbose, query_string, drop_table_on_replace, cascade_on_drop)\\u001b[0m\\n\\u001b[1;32m    259\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m verbose:\\n\\u001b[1;32m    260\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mprinter\\u001b[38;5;241m.\\u001b[39mprint_msg(\\n\\u001b[1;32m    261\\u001b[0m         \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mExporting data to \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mfull_table_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    262\\u001b[0m     ):\\n\\u001b[0;32m--> 263\\u001b[0m         \\u001b[43m__process\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    264\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    265\\u001b[0m     __process()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:249\\u001b[0m, in \\u001b[0;36mBaseSQL.export.<locals>.__process\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m    244\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m ExportWritePolicy\\u001b[38;5;241m.\\u001b[39mAPPEND \\u001b[38;5;241m==\\u001b[39m if_exists \\u001b[38;5;129;01mand\\u001b[39;00m table_exists:\\n\\u001b[1;32m    245\\u001b[0m         query \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mINSERT INTO \\u001b[39m\\u001b[38;5;132;01m{}\\u001b[39;00m\\u001b[38;5;130;01m\\\\n\\u001b[39;00m\\u001b[38;5;132;01m{}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;241m.\\u001b[39mformat(\\n\\u001b[1;32m    246\\u001b[0m             full_table_name,\\n\\u001b[1;32m    247\\u001b[0m             query_string,\\n\\u001b[1;32m    248\\u001b[0m         )\\n\\u001b[0;32m--> 249\\u001b[0m     \\u001b[43mcur\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mquery\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    250\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    251\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m should_create_table:\\n\", \"\\u001b[0;31mUndefinedTable\\u001b[0m: relation \\\"mage.dev_example_pipeline_export_titanic_clean_v1\\\" does not exist\\nLINE 4: SELECT * FROM mage.dev_example_pipeline_export_titanic_clean...\\n                      ^\\n\"], \"error\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mUndefinedTable\\u001b[0m                            Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[6], line 57\\u001b[0m\\n\\u001b[1;32m     54\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     55\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m find(\\u001b[38;5;28;01mlambda\\u001b[39;00m val: val \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m, output)\\n\\u001b[0;32m---> 57\\u001b[0m df \\u001b[38;5;241m=\\u001b[39m \\u001b[43mexecute_custom_code\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     59\\u001b[0m \\u001b[38;5;66;03m# Post processing code below (source: output_display.py)\\u001b[39;00m\\n\\u001b[1;32m     62\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__custom_output\\u001b[39m():\\n\", \"Cell \\u001b[0;32mIn[6], line 36\\u001b[0m, in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     33\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m:\\n\\u001b[1;32m     34\\u001b[0m     \\u001b[38;5;28;01mpass\\u001b[39;00m\\n\\u001b[0;32m---> 36\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_sync\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m     37\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcode\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     38\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     39\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43manalyze_outputs\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mFalse\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     40\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mupdate_status\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     41\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     42\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     43\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28;01mTrue\\u001b[39;00m:\\n\\u001b[1;32m     44\\u001b[0m     block\\u001b[38;5;241m.\\u001b[39mrun_tests(\\n\\u001b[1;32m     45\\u001b[0m         custom_code\\u001b[38;5;241m=\\u001b[39mcode,\\n\\u001b[1;32m     46\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m     47\\u001b[0m         from_notebook\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mTrue\\u001b[39;00m,\\n\\u001b[1;32m     48\\u001b[0m         update_tests\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m     49\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:649\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    640\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m logger \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    641\\u001b[0m         logger\\u001b[38;5;241m.\\u001b[39mexception(\\n\\u001b[1;32m    642\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mFailed to execute block \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    643\\u001b[0m             \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mmerge_dict(logging_tags, \\u001b[38;5;28mdict\\u001b[39m(\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    647\\u001b[0m             ))\\n\\u001b[1;32m    648\\u001b[0m         )\\n\\u001b[0;32m--> 649\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m err\\n\\u001b[1;32m    650\\u001b[0m \\u001b[38;5;28;01mfinally\\u001b[39;00m:\\n\\u001b[1;32m    651\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m update_status:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:581\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    575\\u001b[0m         upstream_block_uuids \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(\\u001b[38;5;28mmap\\u001b[39m(\\u001b[38;5;28;01mlambda\\u001b[39;00m b: b\\u001b[38;5;241m.\\u001b[39muuid, not_executed_upstream_blocks))\\n\\u001b[1;32m    576\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m(\\n\\u001b[1;32m    577\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mBlock \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124ms upstream blocks have not been executed yet. \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m    578\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mPlease run upstream blocks \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mupstream_block_uuids\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    579\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mbefore running the current block.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    580\\u001b[0m         )\\n\\u001b[0;32m--> 581\\u001b[0m output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    582\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    583\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    584\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    585\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    586\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    587\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    588\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    589\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    590\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    591\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    592\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    593\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    594\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m output[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124moutput\\u001b[39m\\u001b[38;5;124m'\\u001b[39m] \\u001b[38;5;129;01mor\\u001b[39;00m []\\n\\u001b[1;32m    595\\u001b[0m variable_mapping \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:808\\u001b[0m, in \\u001b[0;36mBlock.execute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, input_args, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    805\\u001b[0m     outputs_from_input_vars \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\\u001b[1;32m    807\\u001b[0m \\u001b[38;5;28;01mwith\\u001b[39;00m redirect_stdout(stdout):\\n\\u001b[0;32m--> 808\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_execute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    809\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43moutputs_from_input_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    810\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    811\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    812\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    813\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    814\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    815\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    816\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    817\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    818\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    819\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\n\\u001b[1;32m    820\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    822\\u001b[0m output_message \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m(output\\u001b[38;5;241m=\\u001b[39moutputs)\\n\\u001b[1;32m    824\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m output_message\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/sql/__init__.py:370\\u001b[0m, in \\u001b[0;36mSQLBlock._execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, execution_partition, global_vars, **kwargs)\\u001b[0m\\n\\u001b[1;32m    362\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m_execute_block\\u001b[39m(\\n\\u001b[1;32m    363\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m,\\n\\u001b[1;32m    364\\u001b[0m     outputs_from_input_vars,\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    368\\u001b[0m     \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mkwargs,\\n\\u001b[1;32m    369\\u001b[0m ) \\u001b[38;5;241m-\\u001b[39m\\u001b[38;5;241m>\\u001b[39m List:\\n\\u001b[0;32m--> 370\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[43mexecute_sql_code\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    371\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    372\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;129;43;01mor\\u001b[39;49;00m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mcontent\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    373\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    374\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    375\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/sql/__init__.py:174\\u001b[0m, in \\u001b[0;36mexecute_sql_code\\u001b[0;34m(block, query, execution_partition, global_vars, config_file_loader, configuration)\\u001b[0m\\n\\u001b[1;32m    167\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m execute_raw_sql(\\n\\u001b[1;32m    168\\u001b[0m         loader,\\n\\u001b[1;32m    169\\u001b[0m         block,\\n\\u001b[1;32m    170\\u001b[0m         query_string,\\n\\u001b[1;32m    171\\u001b[0m         should_query\\u001b[38;5;241m=\\u001b[39mshould_query,\\n\\u001b[1;32m    172\\u001b[0m     )\\n\\u001b[1;32m    173\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[0;32m--> 174\\u001b[0m     \\u001b[43mloader\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexport\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    175\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;28;43;01mNone\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    176\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mschema\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    177\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtable_name\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    178\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mquery_string\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mquery_string\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    179\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43mkwargs_shared\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    180\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    182\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m should_query:\\n\\u001b[1;32m    183\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m [\\n\\u001b[1;32m    184\\u001b[0m             loader\\u001b[38;5;241m.\\u001b[39mload(\\n\\u001b[1;32m    185\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mSELECT * FROM \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mschema\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m.\\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mtable_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    186\\u001b[0m                 verbose\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m    187\\u001b[0m             ),\\n\\u001b[1;32m    188\\u001b[0m         ]\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:263\\u001b[0m, in \\u001b[0;36mBaseSQL.export\\u001b[0;34m(self, df, schema_name, table_name, if_exists, index, verbose, query_string, drop_table_on_replace, cascade_on_drop)\\u001b[0m\\n\\u001b[1;32m    259\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m verbose:\\n\\u001b[1;32m    260\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mprinter\\u001b[38;5;241m.\\u001b[39mprint_msg(\\n\\u001b[1;32m    261\\u001b[0m         \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mExporting data to \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mfull_table_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    262\\u001b[0m     ):\\n\\u001b[0;32m--> 263\\u001b[0m         \\u001b[43m__process\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    264\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    265\\u001b[0m     __process()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:249\\u001b[0m, in \\u001b[0;36mBaseSQL.export.<locals>.__process\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m    244\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m ExportWritePolicy\\u001b[38;5;241m.\\u001b[39mAPPEND \\u001b[38;5;241m==\\u001b[39m if_exists \\u001b[38;5;129;01mand\\u001b[39;00m table_exists:\\n\\u001b[1;32m    245\\u001b[0m         query \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mINSERT INTO \\u001b[39m\\u001b[38;5;132;01m{}\\u001b[39;00m\\u001b[38;5;130;01m\\\\n\\u001b[39;00m\\u001b[38;5;132;01m{}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;241m.\\u001b[39mformat(\\n\\u001b[1;32m    246\\u001b[0m             full_table_name,\\n\\u001b[1;32m    247\\u001b[0m             query_string,\\n\\u001b[1;32m    248\\u001b[0m         )\\n\\u001b[0;32m--> 249\\u001b[0m     \\u001b[43mcur\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mquery\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    250\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    251\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m should_create_table:\\n\", \"\\u001b[0;31mUndefinedTable\\u001b[0m: relation \\\"mage.dev_example_pipeline_export_titanic_clean_v1\\\" does not exist\\nLINE 4: SELECT * FROM mage.dev_example_pipeline_export_titanic_clean...\\n                      ^\\n\"], \"execution_state\": null, \"metadata\": null, \"msg_id\": \"a3b8f67b-6ef3350ad6daf0b566e855fd_7_5\", \"msg_type\": \"error\", \"type\": \"text\", \"uuid\": \"crimson_shadow\", \"pipeline_uuid\": null}"