"{\"data\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mAttributeError\\u001b[0m                            Traceback (most recent call last)\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/base.py:312\\u001b[0m, in \\u001b[0;36mBaseSQLConnection.conn\\u001b[0;34m(self)\\u001b[0m\\n\\u001b[1;32m    311\\u001b[0m \\u001b[38;5;28;01mtry\\u001b[39;00m:\\n\\u001b[0;32m--> 312\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_ctx\\u001b[49m\\n\\u001b[1;32m    313\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mAttributeError\\u001b[39;00m:\\n\", \"\\u001b[0;31mAttributeError\\u001b[0m: 'Postgres' object has no attribute '_ctx'\", \"\\nDuring handling of the above exception, another exception occurred:\\n\", \"\\u001b[0;31mConnectionError\\u001b[0m                           Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[5], line 87\\u001b[0m\\n\\u001b[1;32m     84\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     85\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m find(\\u001b[38;5;28;01mlambda\\u001b[39;00m val: val \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m, output)\\n\\u001b[0;32m---> 87\\u001b[0m df \\u001b[38;5;241m=\\u001b[39m \\u001b[43mexecute_custom_code\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     89\\u001b[0m \\u001b[38;5;66;03m# Post processing code below (source: output_display.py)\\u001b[39;00m\\n\\u001b[1;32m     92\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__custom_output\\u001b[39m():\\n\", \"Cell \\u001b[0;32mIn[5], line 66\\u001b[0m, in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     63\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m:\\n\\u001b[1;32m     64\\u001b[0m     \\u001b[38;5;28;01mpass\\u001b[39;00m\\n\\u001b[0;32m---> 66\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_sync\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m     67\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcode\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     68\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     69\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43manalyze_outputs\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mFalse\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     70\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mupdate_status\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     71\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     72\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     73\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28;01mTrue\\u001b[39;00m:\\n\\u001b[1;32m     74\\u001b[0m     block\\u001b[38;5;241m.\\u001b[39mrun_tests(\\n\\u001b[1;32m     75\\u001b[0m         custom_code\\u001b[38;5;241m=\\u001b[39mcode,\\n\\u001b[1;32m     76\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m     77\\u001b[0m         from_notebook\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mTrue\\u001b[39;00m,\\n\\u001b[1;32m     78\\u001b[0m         update_tests\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m     79\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:649\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    640\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m logger \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    641\\u001b[0m         logger\\u001b[38;5;241m.\\u001b[39mexception(\\n\\u001b[1;32m    642\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mFailed to execute block \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    643\\u001b[0m             \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mmerge_dict(logging_tags, \\u001b[38;5;28mdict\\u001b[39m(\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    647\\u001b[0m             ))\\n\\u001b[1;32m    648\\u001b[0m         )\\n\\u001b[0;32m--> 649\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m err\\n\\u001b[1;32m    650\\u001b[0m \\u001b[38;5;28;01mfinally\\u001b[39;00m:\\n\\u001b[1;32m    651\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m update_status:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:581\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    575\\u001b[0m         upstream_block_uuids \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(\\u001b[38;5;28mmap\\u001b[39m(\\u001b[38;5;28;01mlambda\\u001b[39;00m b: b\\u001b[38;5;241m.\\u001b[39muuid, not_executed_upstream_blocks))\\n\\u001b[1;32m    576\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m(\\n\\u001b[1;32m    577\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mBlock \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124ms upstream blocks have not been executed yet. \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m    578\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mPlease run upstream blocks \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mupstream_block_uuids\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    579\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mbefore running the current block.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    580\\u001b[0m         )\\n\\u001b[0;32m--> 581\\u001b[0m output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    582\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    583\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    584\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    585\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    586\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    587\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    588\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    589\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    590\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    591\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    592\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    593\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    594\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m output[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124moutput\\u001b[39m\\u001b[38;5;124m'\\u001b[39m] \\u001b[38;5;129;01mor\\u001b[39;00m []\\n\\u001b[1;32m    595\\u001b[0m variable_mapping \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:808\\u001b[0m, in \\u001b[0;36mBlock.execute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, input_args, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    805\\u001b[0m     outputs_from_input_vars \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\\u001b[1;32m    807\\u001b[0m \\u001b[38;5;28;01mwith\\u001b[39;00m redirect_stdout(stdout):\\n\\u001b[0;32m--> 808\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_execute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    809\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43moutputs_from_input_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    810\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    811\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    812\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    813\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    814\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    815\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    816\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    817\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    818\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    819\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\n\\u001b[1;32m    820\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    822\\u001b[0m output_message \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m(output\\u001b[38;5;241m=\\u001b[39moutputs)\\n\\u001b[1;32m    824\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m output_message\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:870\\u001b[0m, in \\u001b[0;36mBlock._execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, execution_partition, input_vars, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    868\\u001b[0m block_function \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_validate_execution(decorated_functions, input_vars)\\n\\u001b[1;32m    869\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m block_function \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[0;32m--> 870\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block_function\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    871\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mblock_function\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    872\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    873\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m__enrich_global_vars\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    874\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    875\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    877\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m outputs \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    878\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m []\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:896\\u001b[0m, in \\u001b[0;36mBlock.execute_block_function\\u001b[0;34m(self, block_function, input_vars, global_vars, test_execution)\\u001b[0m\\n\\u001b[1;32m    894\\u001b[0m has_kwargs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28many\\u001b[39m([p\\u001b[38;5;241m.\\u001b[39mkind \\u001b[38;5;241m==\\u001b[39m p\\u001b[38;5;241m.\\u001b[39mVAR_KEYWORD \\u001b[38;5;28;01mfor\\u001b[39;00m p \\u001b[38;5;129;01min\\u001b[39;00m sig\\u001b[38;5;241m.\\u001b[39mparameters\\u001b[38;5;241m.\\u001b[39mvalues()])\\n\\u001b[1;32m    895\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m has_kwargs \\u001b[38;5;129;01mand\\u001b[39;00m global_vars \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m \\u001b[38;5;129;01mand\\u001b[39;00m \\u001b[38;5;28mlen\\u001b[39m(global_vars) \\u001b[38;5;241m!=\\u001b[39m \\u001b[38;5;241m0\\u001b[39m:\\n\\u001b[0;32m--> 896\\u001b[0m     output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock_function\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    897\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    898\\u001b[0m     output \\u001b[38;5;241m=\\u001b[39m block_function(\\u001b[38;5;241m*\\u001b[39minput_vars)\\n\", \"File \\u001b[0;32m<string>:26\\u001b[0m, in \\u001b[0;36mexport_data_to_postgres\\u001b[0;34m(df, **kwargs)\\u001b[0m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:263\\u001b[0m, in \\u001b[0;36mBaseSQL.export\\u001b[0;34m(self, df, schema_name, table_name, if_exists, index, verbose, query_string, drop_table_on_replace, cascade_on_drop)\\u001b[0m\\n\\u001b[1;32m    259\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m verbose:\\n\\u001b[1;32m    260\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mprinter\\u001b[38;5;241m.\\u001b[39mprint_msg(\\n\\u001b[1;32m    261\\u001b[0m         \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mExporting data to \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mfull_table_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    262\\u001b[0m     ):\\n\\u001b[0;32m--> 263\\u001b[0m         \\u001b[43m__process\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    264\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    265\\u001b[0m     __process()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:215\\u001b[0m, in \\u001b[0;36mBaseSQL.export.<locals>.__process\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m    213\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__process\\u001b[39m():\\n\\u001b[1;32m    214\\u001b[0m     buffer \\u001b[38;5;241m=\\u001b[39m StringIO()\\n\\u001b[0;32m--> 215\\u001b[0m     table_exists \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mtable_exists\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mschema_name\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mtable_name\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    217\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mconn\\u001b[38;5;241m.\\u001b[39mcursor() \\u001b[38;5;28;01mas\\u001b[39;00m cur:\\n\\u001b[1;32m    218\\u001b[0m         \\u001b[38;5;28;01mif\\u001b[39;00m schema_name:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/postgres.py:128\\u001b[0m, in \\u001b[0;36mPostgres.table_exists\\u001b[0;34m(self, schema_name, table_name)\\u001b[0m\\n\\u001b[1;32m    127\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mtable_exists\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m, schema_name: \\u001b[38;5;28mstr\\u001b[39m, table_name: \\u001b[38;5;28mstr\\u001b[39m) \\u001b[38;5;241m-\\u001b[39m\\u001b[38;5;241m>\\u001b[39m \\u001b[38;5;28mbool\\u001b[39m:\\n\\u001b[0;32m--> 128\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mconn\\u001b[49m\\u001b[38;5;241m.\\u001b[39mcursor() \\u001b[38;5;28;01mas\\u001b[39;00m cur:\\n\\u001b[1;32m    129\\u001b[0m         cur\\u001b[38;5;241m.\\u001b[39mexecute(\\n\\u001b[1;32m    130\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mSELECT * FROM pg_tables WHERE schemaname = \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mschema_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m AND \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    131\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mtablename = \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mtable_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    132\\u001b[0m         )\\n\\u001b[1;32m    133\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28mbool\\u001b[39m(cur\\u001b[38;5;241m.\\u001b[39mrowcount)\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/base.py:314\\u001b[0m, in \\u001b[0;36mBaseSQLConnection.conn\\u001b[0;34m(self)\\u001b[0m\\n\\u001b[1;32m    312\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_ctx\\n\\u001b[1;32m    313\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mAttributeError\\u001b[39;00m:\\n\\u001b[0;32m--> 314\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mConnectionError\\u001b[39;00m(\\n\\u001b[1;32m    315\\u001b[0m         \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mNo connection currently open. Open a new connection to access this property.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    316\\u001b[0m     )\\n\", \"\\u001b[0;31mConnectionError\\u001b[0m: No connection currently open. Open a new connection to access this property.\"], \"error\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mAttributeError\\u001b[0m                            Traceback (most recent call last)\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/base.py:312\\u001b[0m, in \\u001b[0;36mBaseSQLConnection.conn\\u001b[0;34m(self)\\u001b[0m\\n\\u001b[1;32m    311\\u001b[0m \\u001b[38;5;28;01mtry\\u001b[39;00m:\\n\\u001b[0;32m--> 312\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_ctx\\u001b[49m\\n\\u001b[1;32m    313\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mAttributeError\\u001b[39;00m:\\n\", \"\\u001b[0;31mAttributeError\\u001b[0m: 'Postgres' object has no attribute '_ctx'\", \"\\nDuring handling of the above exception, another exception occurred:\\n\", \"\\u001b[0;31mConnectionError\\u001b[0m                           Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[5], line 87\\u001b[0m\\n\\u001b[1;32m     84\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     85\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m find(\\u001b[38;5;28;01mlambda\\u001b[39;00m val: val \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m, output)\\n\\u001b[0;32m---> 87\\u001b[0m df \\u001b[38;5;241m=\\u001b[39m \\u001b[43mexecute_custom_code\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     89\\u001b[0m \\u001b[38;5;66;03m# Post processing code below (source: output_display.py)\\u001b[39;00m\\n\\u001b[1;32m     92\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__custom_output\\u001b[39m():\\n\", \"Cell \\u001b[0;32mIn[5], line 66\\u001b[0m, in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     63\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m:\\n\\u001b[1;32m     64\\u001b[0m     \\u001b[38;5;28;01mpass\\u001b[39;00m\\n\\u001b[0;32m---> 66\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_sync\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m     67\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcode\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     68\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     69\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43manalyze_outputs\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mFalse\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     70\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mupdate_status\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     71\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     72\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     73\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28;01mTrue\\u001b[39;00m:\\n\\u001b[1;32m     74\\u001b[0m     block\\u001b[38;5;241m.\\u001b[39mrun_tests(\\n\\u001b[1;32m     75\\u001b[0m         custom_code\\u001b[38;5;241m=\\u001b[39mcode,\\n\\u001b[1;32m     76\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m     77\\u001b[0m         from_notebook\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mTrue\\u001b[39;00m,\\n\\u001b[1;32m     78\\u001b[0m         update_tests\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m     79\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:649\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    640\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m logger \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    641\\u001b[0m         logger\\u001b[38;5;241m.\\u001b[39mexception(\\n\\u001b[1;32m    642\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mFailed to execute block \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    643\\u001b[0m             \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mmerge_dict(logging_tags, \\u001b[38;5;28mdict\\u001b[39m(\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    647\\u001b[0m             ))\\n\\u001b[1;32m    648\\u001b[0m         )\\n\\u001b[0;32m--> 649\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m err\\n\\u001b[1;32m    650\\u001b[0m \\u001b[38;5;28;01mfinally\\u001b[39;00m:\\n\\u001b[1;32m    651\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m update_status:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:581\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    575\\u001b[0m         upstream_block_uuids \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(\\u001b[38;5;28mmap\\u001b[39m(\\u001b[38;5;28;01mlambda\\u001b[39;00m b: b\\u001b[38;5;241m.\\u001b[39muuid, not_executed_upstream_blocks))\\n\\u001b[1;32m    576\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m(\\n\\u001b[1;32m    577\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mBlock \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124ms upstream blocks have not been executed yet. \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m    578\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mPlease run upstream blocks \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mupstream_block_uuids\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    579\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mbefore running the current block.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    580\\u001b[0m         )\\n\\u001b[0;32m--> 581\\u001b[0m output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    582\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    583\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    584\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    585\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    586\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    587\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    588\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    589\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    590\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    591\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    592\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    593\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    594\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m output[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124moutput\\u001b[39m\\u001b[38;5;124m'\\u001b[39m] \\u001b[38;5;129;01mor\\u001b[39;00m []\\n\\u001b[1;32m    595\\u001b[0m variable_mapping \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:808\\u001b[0m, in \\u001b[0;36mBlock.execute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, input_args, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    805\\u001b[0m     outputs_from_input_vars \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\\u001b[1;32m    807\\u001b[0m \\u001b[38;5;28;01mwith\\u001b[39;00m redirect_stdout(stdout):\\n\\u001b[0;32m--> 808\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_execute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    809\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43moutputs_from_input_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    810\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    811\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    812\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    813\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    814\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    815\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    816\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    817\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    818\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    819\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\n\\u001b[1;32m    820\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    822\\u001b[0m output_message \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m(output\\u001b[38;5;241m=\\u001b[39moutputs)\\n\\u001b[1;32m    824\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m output_message\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:870\\u001b[0m, in \\u001b[0;36mBlock._execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, execution_partition, input_vars, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m    868\\u001b[0m block_function \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_validate_execution(decorated_functions, input_vars)\\n\\u001b[1;32m    869\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m block_function \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[0;32m--> 870\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block_function\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    871\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mblock_function\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    872\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    873\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m__enrich_global_vars\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    874\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    875\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    877\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m outputs \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    878\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m []\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:896\\u001b[0m, in \\u001b[0;36mBlock.execute_block_function\\u001b[0;34m(self, block_function, input_vars, global_vars, test_execution)\\u001b[0m\\n\\u001b[1;32m    894\\u001b[0m has_kwargs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28many\\u001b[39m([p\\u001b[38;5;241m.\\u001b[39mkind \\u001b[38;5;241m==\\u001b[39m p\\u001b[38;5;241m.\\u001b[39mVAR_KEYWORD \\u001b[38;5;28;01mfor\\u001b[39;00m p \\u001b[38;5;129;01min\\u001b[39;00m sig\\u001b[38;5;241m.\\u001b[39mparameters\\u001b[38;5;241m.\\u001b[39mvalues()])\\n\\u001b[1;32m    895\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m has_kwargs \\u001b[38;5;129;01mand\\u001b[39;00m global_vars \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m \\u001b[38;5;129;01mand\\u001b[39;00m \\u001b[38;5;28mlen\\u001b[39m(global_vars) \\u001b[38;5;241m!=\\u001b[39m \\u001b[38;5;241m0\\u001b[39m:\\n\\u001b[0;32m--> 896\\u001b[0m     output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock_function\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    897\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    898\\u001b[0m     output \\u001b[38;5;241m=\\u001b[39m block_function(\\u001b[38;5;241m*\\u001b[39minput_vars)\\n\", \"File \\u001b[0;32m<string>:26\\u001b[0m, in \\u001b[0;36mexport_data_to_postgres\\u001b[0;34m(df, **kwargs)\\u001b[0m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:263\\u001b[0m, in \\u001b[0;36mBaseSQL.export\\u001b[0;34m(self, df, schema_name, table_name, if_exists, index, verbose, query_string, drop_table_on_replace, cascade_on_drop)\\u001b[0m\\n\\u001b[1;32m    259\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m verbose:\\n\\u001b[1;32m    260\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mprinter\\u001b[38;5;241m.\\u001b[39mprint_msg(\\n\\u001b[1;32m    261\\u001b[0m         \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mExporting data to \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mfull_table_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    262\\u001b[0m     ):\\n\\u001b[0;32m--> 263\\u001b[0m         \\u001b[43m__process\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    264\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    265\\u001b[0m     __process()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/sql.py:215\\u001b[0m, in \\u001b[0;36mBaseSQL.export.<locals>.__process\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m    213\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__process\\u001b[39m():\\n\\u001b[1;32m    214\\u001b[0m     buffer \\u001b[38;5;241m=\\u001b[39m StringIO()\\n\\u001b[0;32m--> 215\\u001b[0m     table_exists \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mtable_exists\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mschema_name\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mtable_name\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    217\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mconn\\u001b[38;5;241m.\\u001b[39mcursor() \\u001b[38;5;28;01mas\\u001b[39;00m cur:\\n\\u001b[1;32m    218\\u001b[0m         \\u001b[38;5;28;01mif\\u001b[39;00m schema_name:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/postgres.py:128\\u001b[0m, in \\u001b[0;36mPostgres.table_exists\\u001b[0;34m(self, schema_name, table_name)\\u001b[0m\\n\\u001b[1;32m    127\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mtable_exists\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m, schema_name: \\u001b[38;5;28mstr\\u001b[39m, table_name: \\u001b[38;5;28mstr\\u001b[39m) \\u001b[38;5;241m-\\u001b[39m\\u001b[38;5;241m>\\u001b[39m \\u001b[38;5;28mbool\\u001b[39m:\\n\\u001b[0;32m--> 128\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mconn\\u001b[49m\\u001b[38;5;241m.\\u001b[39mcursor() \\u001b[38;5;28;01mas\\u001b[39;00m cur:\\n\\u001b[1;32m    129\\u001b[0m         cur\\u001b[38;5;241m.\\u001b[39mexecute(\\n\\u001b[1;32m    130\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mSELECT * FROM pg_tables WHERE schemaname = \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mschema_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m AND \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    131\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mtablename = \\u001b[39m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;132;01m{\\u001b[39;00mtable_name\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;130;01m\\\\'\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    132\\u001b[0m         )\\n\\u001b[1;32m    133\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28mbool\\u001b[39m(cur\\u001b[38;5;241m.\\u001b[39mrowcount)\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/io/base.py:314\\u001b[0m, in \\u001b[0;36mBaseSQLConnection.conn\\u001b[0;34m(self)\\u001b[0m\\n\\u001b[1;32m    312\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_ctx\\n\\u001b[1;32m    313\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mAttributeError\\u001b[39;00m:\\n\\u001b[0;32m--> 314\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mConnectionError\\u001b[39;00m(\\n\\u001b[1;32m    315\\u001b[0m         \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mNo connection currently open. Open a new connection to access this property.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    316\\u001b[0m     )\\n\", \"\\u001b[0;31mConnectionError\\u001b[0m: No connection currently open. Open a new connection to access this property.\"], \"execution_state\": null, \"metadata\": null, \"msg_id\": \"08aba871-187f969e11095192bf95b444_7_4\", \"msg_type\": \"error\", \"type\": \"text\", \"uuid\": \"restless_moon\", \"pipeline_uuid\": null}"